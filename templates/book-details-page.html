{% extends 'base.html' %}
{% block title %}Book Detailes Page{% endblock %}

{% block body %}
<div id="" class="">
    {% if 'imageLinks' in book.volumeInfo %}
          <img src="{{book.volumeInfo.imageLinks.get('smallThumbnail', '/static/no-image-available.jpg')}}"
            width="150" 
            height="200">
    {% else %}
          <img src="{{'/static/no-image-available.jpg'}}"
          width="150" 
          height="200">
    {% endif %}
        <h3 class="">Title: {{ book.volumeInfo.title }}</h3>
        <div class="">Authors: {{', '.join(book.volumeInfo.get('authors', ['***']))}}</div>
        <div>Description:
            {% if 'description' in book.volumeInfo %}
                {{book.volumeInfo.description|striptags}}
            {% else %}
                No description so far.
            {% endif %}
        </div>
   <!-- SHowing rating and reviews if book exists in db -->
    <div class="">Rating: {{db_book.rating if db_book is not none else '0'}}</div>
    {% if db_book is not none %}
        <div class="">Reviews: 
            {% for review in db_book.reviews %}
            <ul>
                <li>
                    {{review.text_review}}
                </li>

            </ul>
            
            {% endfor %}
        </div>
    {% endif %}
    {% if session.get("user_id") %}
    <form action="/review" method="POST">
        <textarea id="book_review" name="review" rows="4" cols="50" placeholder='Please enter your review of book "{{ book.volumeInfo.title }}" here.'></textarea>
        <br>
        <input type="submit" value="Submit">
        <input type="hidden" id="googleBookId" name="googleBookId" value="{{book.id}}" />
    </form>
    {% endif %}
</div>

{% endblock %}